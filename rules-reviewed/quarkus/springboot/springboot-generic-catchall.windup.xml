<?xml version="1.0"?>
<ruleset id="springboot-generic-catchall" xmlns="http://windup.jboss.org/schema/jboss-ruleset" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://windup.jboss.org/schema/jboss-ruleset http://windup.jboss.org/schema/jboss-ruleset/windup-jboss-ruleset.xsd">
    <metadata>
        <description>
            This ruleset provides analysis of generic Spring components that may require individual attention when
            migrating to Quarkus.
        </description>
        <dependencies>
            <addon id="org.jboss.windup.rules,windup-rules-javaee,3.0.0.Final" />
            <addon id="org.jboss.windup.rules,windup-rules-java,3.0.0.Final" />
            <addon id="org.jboss.windup.rules,windup-rules-xml,3.0.0.Final" />
        </dependencies>
        <sourceTechnology id="springboot" />
        <targetTechnology id="quarkus" />
        <executeAfter>springboot-actuator-to-quarkus</executeAfter>
        <executeAfter>springboot-annotations-to-quarkus</executeAfter>
        <executeAfter>springboot-cache-to-quarkus</executeAfter>
        <executeAfter>springboot-cloud-config-to-quarkus</executeAfter>
        <executeAfter>springboot-data-jpa-to-quarkus</executeAfter>
        <executeAfter>springboot-devtools-to-quarkus</executeAfter>
        <executeAfter>springboot-di-to-quarkus</executeAfter>
        <executeAfter>springboot-flo-to-quarkus-groovy</executeAfter>
        <executeAfter>springboot-di-to-quarkus</executeAfter>
        <executeAfter>springboot-generic-unsupported-groovy</executeAfter>
        <executeAfter>springboot-di-to-quarkus</executeAfter>
        <executeAfter>springboot-integration-to-quarkus</executeAfter>
        <executeAfter>springboot-jmx-to-quarkus</executeAfter>
        <executeAfter>springboot-metrics-to-quarkus</executeAfter>
        <executeAfter>springboot-parent-pom-to-quarkus</executeAfter>
        <executeAfter>springboot-plugins-to-quarkus</executeAfter>
        <executeAfter>springboot-properties-to-quarkus</executeAfter>
        <executeAfter>springboot-properties-to-quarkus-groovy</executeAfter>
        <executeAfter>springboot-scheduled-to-quarkus</executeAfter>
        <executeAfter>springboot-security-to-quarkus</executeAfter>
        <executeAfter>springboot-shell-to-quarkus</executeAfter>
        <executeAfter>springboot-webmvc-to-quarkus</executeAfter>
        <executeAfter>springboot-web-shaded-to-quarkus</executeAfter>
        <executeAfter>springboot-web-to-quarkus</executeAfter>
    </metadata>
    <rules>
        <rule id="springboot-generic-catchall-00100">
            <when>
                <dependency groupId="{group}" artifactId="{artifact}"/>
            </when>
            <perform>
                <iteration>
                    <when>
                        <not>
                            <has-hint />
                        </not>
                    </when>
                    <perform>
                        <hint title="Spring component {artifact} requires investigation" effort="5" category-id="potential">
                            <message>
                                If the application declares explicitly or uses any of the feature provided by the Spring `{group}:{artifact}` component,
                                then check if there is a Quarkus Extensions with Spring API compatibility for the Spring `{artifact}` component.  
                                If yes, then replace the `{group}:{artifact}` dependency with the Quarkus extension.  
                                If no, consider rewrite the code that relies on this dependency leveraging the Quarkus Guides linked below.  
                                
                                Otherwise, if the application hasn't got this explicit Spring `{group}:{artifact}` component dependency, it has been added transitively by another Spring component.  
                                Once the dependant Spring component will be removed, this issue will be fixed as well.
                            </message>
                            <link title="Quarkus - Guides" href="https://quarkus.io/guides/" />
                            <tag>catchall</tag>
                        </hint>
                    </perform>
                </iteration>
            </perform>
            <where param="group">
                <matches pattern="(org.spring)(.*)?" />
            </where>
            <where param="artifact">
                <matches pattern=".*" />
            </where>
        </rule>
    </rules>
</ruleset>
